---
import MainLayout from '../layouts/MainLayout.astro'
import PrimaryButton from '../components/PrimaryButton.astro';

const h1 = 'My Team';

// Team member data
const lionel = {
  name: "Lionel Adriano",
  role: "Makeup Artist",
  image: "https://images.squarespace-cdn.com/content/v1/50f79c6fe4b00d3480c9bbf0/1591018523037-B15TIOQL6BR1MOFJAT68/Lionel-Adriano+-+%28400px%29+-+Richard+Waine+-+Lancaster-PA_0040.jpg",
  bio: [
    "Lionel is a world-class makeup artist who has worked with some of the world's most recognizable people. He has an amazing eye for color and complexion, and ensures that no detail is overlooked.",
    "Lionel is a certified M.A.C. makeup artist and was voted the best makeup artist in Lancaster County, Pennsylvania by the readers of Lancaster County Magazine, Susquehanna Style Magazine and Lancaster Newspaper.",
    "His attention to detail, positive attitude, and perfectionism gels very well with my operation.",
    "Lionel is an integral part of my workflow and client experience. Let him work his magic on you. Not only will you get pampered, but you will feel more beautiful than you already are!"
  ]
};

const lisa = {
  name: "Lisa Torba",
  role: "Stylist",
  image: "https://images.squarespace-cdn.com/content/v1/50f79c6fe4b00d3480c9bbf0/1577896434536-DDGV5412OJ1KEFT3IOU5/Lisa-Torba+-+%28500px%29+-+Richard+Waine+-+Lancaster-PA-0158.jpg",
  bio: [
    "Lisa is an incredible Personal Stylist for men. She helps to custom fit and style you with high-quality clothing that looks and feels great. She'll make your life easier and have you looking better than ever.",
    "Lisa caters to the needs and schedules of her clients by providing a collaborative, frustration-free shopping experience. After meticulously measuring you to ensure a proper fit, Lisa will guide you through the customization process, and style you to perfection.",
    "Working with Lisa will save you time and money while ensuring that you are among the best dressed in the room, regardless of the occasion.",
    "Contact Lisa ahead of your headshot or branding photo session to ensure you look and feel like a million bucks!"
  ],
  ctaText: "SCHEDULE WITH LISA",
  ctaUrl: "https://clientela.myjhilburn.com/stylist/15327"
};
---

<MainLayout title="My Team - Concept 1">

<main class="team-page-animated">
  <h1 class="page-title">{h1}</h1>
  <div class="team-grid">
    <!-- Left Side - Image/Content Swap -->
    <div class="grid-left">
      <div class="item lionel-image active" data-item="lionel-image">
        <img src={lionel.image} alt={`${lionel.name} - ${lionel.role}`} />
      </div>
      <div class="item lisa-content" data-item="lisa-content">
        <div class="content-box">
          <h2>{lisa.name}</h2>
          <span class="role-label">{lisa.role}</span>
          <div class="bio-content">
            {lisa.bio.map(paragraph => (
              <p>{paragraph}</p>
            ))}
          </div>
          <PrimaryButton url={lisa.ctaUrl} text={lisa.ctaText} />
        </div>
      </div>
    </div>

    <!-- Right Side - Content/Image Swap -->
    <div class="grid-right">
      <div class="item lionel-content active" data-item="lionel-content">
        <div class="content-box">
          <h2>{lionel.name}</h2>
          <span class="role-label">{lionel.role}</span>
          <div class="bio-content">
            {lionel.bio.map(paragraph => (
              <p>{paragraph}</p>
            ))}
          </div>
        </div>
      </div>
      <div class="item lisa-image" data-item="lisa-image">
        <img src={lisa.image} alt={`${lisa.name} - ${lisa.role}`} />
      </div>
    </div>
  </div>


  <!-- Progress Indicator -->
  <div class="progress-indicator">
    <span class="progress-dot active" data-index="0"></span>
    <span class="progress-dot" data-index="1"></span>
  </div>
</main>

<script>
  import gsap from 'gsap';

  let currentIndex = 0;
  let isAnimating = false;

  const lionelImage = document.querySelector<HTMLElement>('.lionel-image');
  const lionelContent = document.querySelector<HTMLElement>('.lionel-content');
  const lisaImage = document.querySelector<HTMLElement>('.lisa-image');
  const lisaContent = document.querySelector<HTMLElement>('.lisa-content');

  const dots = document.querySelectorAll<HTMLElement>('.progress-dot');
  const gridLeft = document.querySelector<HTMLElement>('.grid-left');
  const gridRight = document.querySelector<HTMLElement>('.grid-right');

  // Sync grid heights to tallest item
  function syncGridHeights() {
    if (!lionelImage || !lionelContent || !lisaImage || !lisaContent || !gridLeft || !gridRight) return;

    // Get natural heights of all items
    const lionelImageHeight = lionelImage.offsetHeight;
    const lionelContentHeight = lionelContent.offsetHeight;
    const lisaImageHeight = lisaImage.offsetHeight;
    const lisaContentHeight = lisaContent.offsetHeight;

    // Find the maximum height
    const maxHeight = Math.max(lionelImageHeight, lionelContentHeight, lisaImageHeight, lisaContentHeight);

    // Apply to both grid containers
    gridLeft.style.height = `${maxHeight}px`;
    gridRight.style.height = `${maxHeight}px`;
  }

  // Initialize - hide Lisa's items
  gsap.set([lisaContent, lisaImage], { autoAlpha: 0, y: 100 });

  // Sync heights after initial layout
  setTimeout(syncGridHeights, 100);

  function updateNavigation() {
    dots.forEach((dot, index) => {
      dot.classList.toggle('active', index === currentIndex);
    });
  }

  function animateToIndex(newIndex: number) {
    if (isAnimating || newIndex === currentIndex || newIndex < 0 || newIndex > 1) {
      return;
    }

    isAnimating = true;

    const timeline = gsap.timeline({
      onComplete: () => {
        isAnimating = false;
        currentIndex = newIndex;
        updateNavigation();
      }
    });

    if (newIndex === 1) {
      // Going to Lisa
      // Left side: Lionel image OUT (up), Lisa content IN (up from bottom)
      timeline.to(lionelImage, {
        autoAlpha: 0,
        y: -100,
        duration: 0.7,
        ease: 'power2.inOut'
      }, 0);

      timeline.fromTo(lisaContent,
        { autoAlpha: 0, y: 100 },
        { autoAlpha: 1, y: 0, duration: 0.7, ease: 'power2.inOut' },
        0.15
      );

      // Right side: Lionel content OUT (down), Lisa image IN (down from top)
      timeline.to(lionelContent, {
        autoAlpha: 0,
        y: 100,
        duration: 0.7,
        ease: 'power2.inOut'
      }, 0);

      timeline.fromTo(lisaImage,
        { autoAlpha: 0, y: -100 },
        { autoAlpha: 1, y: 0, duration: 0.7, ease: 'power2.inOut' },
        0.15
      );
    } else {
      // Going back to Lionel
      // Left side: Lisa content OUT (down), Lionel image IN (down from top)
      timeline.to(lisaContent, {
        autoAlpha: 0,
        y: 100,
        duration: 0.7,
        ease: 'power2.inOut'
      }, 0);

      timeline.fromTo(lionelImage,
        { autoAlpha: 0, y: -100 },
        { autoAlpha: 1, y: 0, duration: 0.7, ease: 'power2.inOut' },
        0.15
      );

      // Right side: Lisa image OUT (up), Lionel content IN (up from bottom)
      timeline.to(lisaImage, {
        autoAlpha: 0,
        y: -100,
        duration: 0.7,
        ease: 'power2.inOut'
      }, 0);

      timeline.fromTo(lionelContent,
        { autoAlpha: 0, y: 100 },
        { autoAlpha: 1, y: 0, duration: 0.7, ease: 'power2.inOut' },
        0.15
      );
    }
  }

  // Scroll hijacking - immediate response
  window.addEventListener('wheel', (e) => {
    if (isAnimating) return;
    e.preventDefault();

    if (e.deltaY > 0) {
      animateToIndex(1);
    } else {
      animateToIndex(0);
    }
  }, { passive: false });

  // Dot navigation
  dots.forEach((dot, index) => {
    dot.addEventListener('click', () => animateToIndex(index));
  });

  // Keyboard navigation
  window.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
      animateToIndex(1);
    } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
      animateToIndex(0);
    }
  });

  // Re-sync heights on window resize
  window.addEventListener('resize', syncGridHeights);

  updateNavigation();
</script>

<style is:global>
/* ========================================
   SCROLL-HIJACKED TEAM PAGE
   ======================================== */

body:has(.team-page-animated) {
  overflow: hidden;
  height: 100vh;
  overscroll-behavior: none;
}

html:has(.team-page-animated) {
  overflow: hidden;
  height: 100vh;
  overscroll-behavior: none;
}

.team-page-animated {
  position: relative;
  width: 100%;
  height: 100vh;
  overflow: hidden;
  background: var(--ltclr);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  overscroll-behavior: none;
  padding: var(--size-7) 0;
}

.page-title {
  font-size: var(--fs-800);
  font-weight: var(--fw-bold);
  text-transform: uppercase;
  color: var(--blkclr);
  margin-bottom: var(--size-7);
  letter-spacing: 0.05em;
}

.team-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--size-9);
  max-width: 1400px;
  width: 90%;
  margin: 0 auto;
  align-items: start;
}

.grid-left,
.grid-right {
  position: relative;
  height: 100%;
}

.item {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
}

.item.lionel-image,
.item.lisa-image {
  
  height: auto;
}

.item.lionel-content,
.item.lisa-content {
  height: auto;
  min-height: 600px;
}

.item img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  box-shadow:
    0 25px 60px rgba(0, 0, 0, 0.3),
    0 15px 35px rgba(0, 0, 0, 0.2);
}

/* Content Styling */
.item .content-box {
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: flex-start;
  background: var(--ltbg);
  padding: var(--size-7);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
}

.lionel-content .content-box {
  clip-path: polygon(0 0, 100% 0, 100% calc(100% - 30px), calc(100% - 30px) 100%, 0 100%);
}

.lisa-content .content-box {
  clip-path: polygon(30px 0, 100% 0, 100% 100%, 0 100%, 0 30px);
}

.content-box h2 {
  font-size: clamp(var(--fs-700), 4vw, var(--fs-800));
  font-weight: var(--fw-bold);
  text-transform: uppercase;
  color: var(--blkclr);
  letter-spacing: 0.02em;
  margin-bottom: var(--size-2);
}

.role-label {
  display: inline-block;
  font-size: var(--fs-350);
  font-weight: var(--fw-bold);
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: var(--accent);
  margin-bottom: var(--size-8);
}

.bio-content p {
  font-size: var(--fs-450);
  line-height: var(--line-height-relaxed);
  margin-bottom: var(--size-4);
  color: var(--blkclr);
}

/* Progress Indicator */
.progress-indicator {
  position: fixed;
  bottom: var(--size-7);
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: var(--size-3);
  z-index: 100;
}

.progress-dot {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: transparent;
  border: 2px solid var(--accent);
  cursor: pointer;
  transition: all 0.3s ease;
}

.progress-dot.active {
  background: var(--accent);
  transform: scale(1.3);
}

.progress-dot:hover {
  background: var(--accent);
}

/* Responsive */
@media (max-width: 1024px) {
  .team-grid {
    grid-template-columns: 1fr;
    gap: var(--size-7);
    width: 95%;
  }

  .grid-left,
  .grid-right {
    max-width: 600px;
    margin: 0 auto;
  }
}

@media (max-width: 768px) {
  .content-box {
    padding: var(--size-5);
  }
}
</style>

</MainLayout>
