---
// @ts-nocheck
// TEST PAGE: Showcase Container Travel Animation (Hero â†’ Problem)

import MainLayout from '../layouts/MainLayout.astro';
import Hero from '../components/Hero.astro';
import { Image } from 'astro:assets';
import image0090 from '../assets/images/problem/Headshot_20250917_Sonya Lilienstein_Richard Waine_Lancaster_PA_0090 (horizontal) - compressed.jpg';
import image0056 from '../assets/images/problem/Headshot_20250917_Sonya Lilienstein_Richard Waine_Lancaster_PA_0056 (horizontal) - compressed.jpg';
import image0079 from '../assets/images/problem/Headshot_20250917_Sonya Lilienstein_Richard Waine_Lancaster_PA_0079 (horizontal) - compressed.jpg';

const title = 'Showcase Travel Test';

// Hero section content (duplicated from index.astro)
const heroContent = {
  title: ["WORLD CLASS", "HEADSHOT", "EXPERIENCE"],
  subtitle: "Beyond photography. We craft your professional presence with cinematic precision, luxury service, and results that open doors.",
  primaryButtonText: "GET PRICING",
  secondaryButtonText: "SCHEDULE CONSULTATION",
  heroImages: [
    '/src/assets/images/hero-images/Ken Giglio (16 x 9) - compressed.jpg',
    '/src/assets/images/hero-images/Cindy Nguyen (16 x 9) - compressed.jpg'
  ]
};
---

<MainLayout title={title}>

	<Hero
		title={heroContent.title}
		subtitle={heroContent.subtitle}
		primaryButtonText={heroContent.primaryButtonText}
		secondaryButtonText={heroContent.secondaryButtonText}
		heroImages={heroContent.heroImages}
	/>

	<!-- Triptych images (hidden, will be inserted into container) -->
	<div class="triptych-wrapper" id="triptych-source" style="display: none;">
		<Image src={image0090} alt="" class="triptych-image" />
		<Image src={image0056} alt="" class="triptych-image" />
		<Image src={image0079} alt="" class="triptych-image" />
	</div>

	<!-- Problem section - NO images visible, only text -->
	<section id="problem">
		<div class="problem-content">
			<div class="showcase-target"></div>
			<div class="problem-text">
				<h2>DO YOU HATE HAVING YOUR PICTURE TAKEN?</h2>
				<p>LACK OF CONFIDENCE, FEAR OF FAILURE, AND FEELING THAT YOU AREN'T PHOTOGENIC, PREVENT YOU FROM SHOWING YOUR TRUE SELF</p>
				<p class="accent">A <span class="highlight">PROFESSIONAL HEADSHOT</span> EXPERIENCE CAN CHANGE EVERYTHING</p>
			</div>
		</div>
	</section>

</MainLayout>

<style is:global>
	#problem {
		min-height: 100vh;
		display: flex;
		align-items: center;
		justify-content: center;
	}

	.problem-content {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		gap: 4rem;
		width: 100%;
	}

	.problem-text {
		text-align: center;
		max-width: 800px;
		color:var(--drkclr);
		opacity: 0;
		transform: translateY(50px);
	}

	.problem-text h2 {
		font-size: 32px;
		font-weight: 700;
		text-transform: uppercase;
		margin-bottom: 1.5rem;
	}

	.problem-text p {
		font-size: 18px;
		line-height: 1.6;
		margin-bottom: 1rem;
	}

	.problem-text .accent {
		font-size: 20px;
		font-weight: 700;
	}

	.problem-text .highlight {
		color: #03a9f4;
	}

	/* Triptych wrapper and images */
	.triptych-wrapper {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		display: flex;
		gap: 0;
		opacity: 0;
		z-index: 2;
	}

	.triptych-wrapper img {
		flex: 1;
		width: 33.33%;
		height: 100%;
		object-fit: cover;
		display: block;
	}

	.triptych-wrapper > :nth-child(1) img {
		clip-path: polygon(0 0, 100% 0, 85% 100%, 0 100%);
	}

	.triptych-wrapper > :nth-child(2) {
		margin-left: -15%;
	}

	.triptych-wrapper > :nth-child(2) img {
		clip-path: polygon(15% 0, 100% 0, 85% 100%, 0 100%);
	}

	.triptych-wrapper > :nth-child(3) {
		margin-left: -15%;
	}

	.triptych-wrapper > :nth-child(3) img {
		clip-path: polygon(15% 0, 100% 0, 100% 100%, 0 100%);
	}
</style>

<script>
	import gsap from 'gsap';
	import { ScrollTrigger } from 'gsap/ScrollTrigger';

	gsap.registerPlugin(ScrollTrigger);

	document.addEventListener('astro:page-load', () => {
		setupShowcaseTravel();
	});

	function setupShowcaseTravel() {
		const showcaseContainer = document.querySelector('.showcase-container') as HTMLElement;
		const problemSection = document.querySelector('#problem') as HTMLElement;
		const problemText = document.querySelector('.problem-text') as HTMLElement;
		const imageLayerForeground = document.querySelector('.image-layer.foreground') as HTMLElement;
		const heroImages = document.querySelectorAll('.hero-image') as NodeListOf<HTMLElement>;

		if (!showcaseContainer || !problemSection || !problemText || !imageLayerForeground) {
			return;
		}

		// Move triptych into container
		const triptychSource = document.getElementById('triptych-source');
		if (triptychSource) {
			triptychSource.style.display = 'flex';
			imageLayerForeground.appendChild(triptychSource);
		}
		const triptychWrapper = document.querySelector('.triptych-wrapper');

		if (!triptychWrapper) {
			console.warn('Triptych wrapper not found');
			return;
		}

		// Animate showcase container with scroll
		gsap.timeline({
			scrollTrigger: {
				trigger: problemSection,
				start: 'top bottom',
				end: '0% 0%',
				scrub: true,
				onUpdate: (self) => {
					if (self.progress > 0) {
						showcaseContainer.style.animation = 'none';
					} else {
						showcaseContainer.style.animation = 'showcaseFloat 12s ease-in-out infinite';
					}
				}
			}
		})
		.to(showcaseContainer, {
			xPercent:-50,
			yPercent: 210,
			scale: 1.75,
			rotationX: 0,
			rotationY: 0,
			ease: 'none'
		})
		.to(heroImages, {
			opacity: 0,
			duration: 0.1,
			ease: 'none'
		}, 0.7)
		.to(triptychWrapper, {
			opacity: 1,
			duration: 0.2,
			ease: 'none'
		}, 0.8)
		.to(problemText, {
			opacity: 1,
			y: 0,
			ease: 'power2.out'
		}, '>-0.2');

		console.log('Animation initialized');
	}
</script>
