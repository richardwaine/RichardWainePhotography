---
import MainLayout from '../layouts/MainLayout.astro'
import PrimaryButton from '../components/PrimaryButton.astro';
import PageTitle from '../components/PageTitle.astro';

const h1 = 'My Team';

// Team member data
const lionel = {
  name: "Lionel Adriano",
  role: "Makeup Artist",
  image: "src/assets/images/team/LionelAdriano - 0040 (horizontal).jpg",
  bio: [
    "Lionel is a world-class makeup artist who has worked with some of the world's most recognizable people. He has an amazing eye for color and complexion, and ensures that no detail is overlooked.",
    "Lionel is a certified M.A.C. makeup artist and was voted the best makeup artist in Lancaster County, Pennsylvania by the readers of Lancaster County Magazine, Susquehanna Style Magazine and Lancaster Newspaper.",
    "His attention to detail, positive attitude, and perfectionism gels very well with my operation.",
    "Lionel is an integral part of my workflow and client experience. Let him work his magic on you. Not only will you get pampered, but you will feel more beautiful than you already are!"
  ]
};

const lisa = {
  name: "Lisa Torba",
  role: "Stylist",
  image: "src/assets/images/team/LisaTorba - 0158 (horizontal).jpg",
  bio: [
    "Lisa is an incredible Personal Stylist for men. She styles you in high-quality clothing that fits perfectly and looks and feels amazing, making your life easier and your wardrobe sharper than ever.",
    "She provides a collaborative, frustration-free shopping experience, meticulously measuring you and guiding every step of the customization process.",
    "Working with Lisa saves you time and money while ensuring you are among the best dressed in the room, no matter the occasion.",
    "Contact Lisa ahead of your headshot or branding photo session to ensure you look and feel like a million bucks!"
  ],
  ctaText: "SCHEDULE WITH LISA",
  ctaUrl: "https://clientela.myjhilburn.com/stylist/15327"
};
---

<MainLayout title="My Team" description="I work with the best in the business. Here are the members of my team and how they can help to elevate your personal brand.">

<PageTitle title={h1} subtitle="Meet the Richard Waine Team" />

<main class="team-page-animated">
    <div class="team-grid">
    <!-- Left Side - Image/Content Swap -->
    <div class="grid-left">
      <div class="item lionel-image active" data-item="lionel-image">
        <img src={lionel.image} alt={`${lionel.name} - ${lionel.role}`} loading="lazy" />
      </div>
      <div class="item lisa-content" data-item="lisa-content">
        <div class="content-box">
          <h2>{lisa.name}</h2>
          <span class="role-label">{lisa.role}</span>
          <div class="bio-content">
            {lisa.bio.map(paragraph => (
              <p>{paragraph}</p>
            ))}
          </div>

          <PrimaryButton  url={lisa.ctaUrl} text={lisa.ctaText}/>

        </div>
      </div>
    </div>

    <!-- Right Side - Content/Image Swap -->
    <div class="grid-right">
      <div class="item lionel-content active" data-item="lionel-content">
        <div class="content-box">
          <h2>{lionel.name}</h2>
          <span class="role-label">{lionel.role}</span>
          <div class="bio-content">
            {lionel.bio.map(paragraph => (
              <p>{paragraph}</p>
            ))}
          </div>
        </div>
      </div>
      <div class="item lisa-image" data-item="lisa-image">
        <img src={lisa.image} alt={`${lisa.name} - ${lisa.role}`} loading="lazy" />
      </div>
    </div>
  </div>

  <!-- Navigation Controls -->
  <div class="team-navigation">
    <button class="nav-arrow nav-prev" aria-label="Previous team member" id="nav-prev">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="15 18 9 12 15 6"></polyline>
      </svg>
    </button>
    <button class="nav-arrow nav-next" aria-label="Next team member" id="nav-next">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    </button>
  </div>
</main>

<script>
  import gsap from 'gsap';

  let currentIndex = 0;
  let isAnimating = false;

  const lionelImage = document.querySelector<HTMLElement>('.lionel-image');
  const lionelContent = document.querySelector<HTMLElement>('.lionel-content');
  const lisaImage = document.querySelector<HTMLElement>('.lisa-image');
  const lisaContent = document.querySelector<HTMLElement>('.lisa-content');

  const gridLeft = document.querySelector<HTMLElement>('.grid-left');
  const gridRight = document.querySelector<HTMLElement>('.grid-right');

  // Navigation elements
  const navPrev = document.querySelector<HTMLButtonElement>('#nav-prev');
  const navNext = document.querySelector<HTMLButtonElement>('#nav-next');

  // Update navigation UI state
  function updateNavigation() {
    // Update arrow buttons
    if (navPrev && navNext) {
      navPrev.disabled = currentIndex === 0;
      navNext.disabled = currentIndex === 1;
    }
  }

  // Sync grid heights to tallest item
  function syncGridHeights() {
    if (!lionelImage || !lionelContent || !lisaImage || !lisaContent || !gridLeft || !gridRight) return;

    // Get natural heights of all items
    const lionelImageHeight = lionelImage.offsetHeight;
    const lionelContentHeight = lionelContent.offsetHeight;
    const lisaImageHeight = lisaImage.offsetHeight;
    const lisaContentHeight = lisaContent.offsetHeight;

    // Find the maximum height
    const maxHeight = Math.max(lionelImageHeight, lionelContentHeight, lisaImageHeight, lisaContentHeight);

    // Apply to both grid containers
    gridLeft.style.height = `${maxHeight}px`;
    gridRight.style.height = `${maxHeight}px`;
  }

  // Initialize - hide Lisa's items
  gsap.set([lisaContent, lisaImage], { autoAlpha: 0, y: 100 });

  // Sync heights after initial layout
  setTimeout(syncGridHeights, 100);

  function animateToIndex(newIndex: number) {
    if (isAnimating || newIndex === currentIndex || newIndex < 0 || newIndex > 1) {
      return;
    }

    isAnimating = true;

    const timeline = gsap.timeline({
      onComplete: () => {
        isAnimating = false;
        currentIndex = newIndex;
        updateNavigation();
      }
    });

    if (newIndex === 1) {
      // Going to Lisa
      // Left side: Lionel image OUT (up), Lisa content IN (up from bottom)
      timeline.to(lionelImage, {
        autoAlpha: 0,
        y: -100,
        duration: 0.7,
        ease: 'power2.inOut'
      }, 0);

      timeline.fromTo(lisaContent,
        { autoAlpha: 0, y: 100 },
        { autoAlpha: 1, y: 0, duration: 0.7, ease: 'power2.inOut' },
        0.15
      );

      // Right side: Lionel content OUT (down), Lisa image IN (down from top)
      timeline.to(lionelContent, {
        autoAlpha: 0,
        y: 100,
        duration: 0.7,
        ease: 'power2.inOut'
      }, 0);

      timeline.fromTo(lisaImage,
        { autoAlpha: 0, y: -100 },
        { autoAlpha: 1, y: 0, duration: 0.7, ease: 'power2.inOut' },
        0.15
      );
    } else {
      // Going back to Lionel
      // Left side: Lisa content OUT (down), Lionel image IN (down from top)
      timeline.to(lisaContent, {
        autoAlpha: 0,
        y: 100,
        duration: 0.7,
        ease: 'power2.inOut'
      }, 0);

      timeline.fromTo(lionelImage,
        { autoAlpha: 0, y: -100 },
        { autoAlpha: 1, y: 0, duration: 0.7, ease: 'power2.inOut' },
        0.15
      );

      // Right side: Lisa image OUT (up), Lionel content IN (up from bottom)
      timeline.to(lisaImage, {
        autoAlpha: 0,
        y: -100,
        duration: 0.7,
        ease: 'power2.inOut'
      }, 0);

      timeline.fromTo(lionelContent,
        { autoAlpha: 0, y: 100 },
        { autoAlpha: 1, y: 0, duration: 0.7, ease: 'power2.inOut' },
        0.15
      );
    }
  }

  // Scroll hijacking - immediate response
  window.addEventListener('wheel', (e) => {
    if (isAnimating) return;
    e.preventDefault();

    if (e.deltaY > 0) {
      animateToIndex(1);
    } else {
      animateToIndex(0);
    }
  }, { passive: false });

  // Keyboard navigation
  window.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
      animateToIndex(1);
    } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
      animateToIndex(0);
    }
  });

  // Navigation button clicks
  navPrev?.addEventListener('click', () => {
    animateToIndex(0);
  });

  navNext?.addEventListener('click', () => {
    animateToIndex(1);
  });

  // Re-sync heights on window resize
  window.addEventListener('resize', syncGridHeights);

  // Initialize navigation state
  updateNavigation();
</script>

<style is:global>
/* ========================================
   SCROLL-HIJACKED TEAM PAGE
   ======================================== */

body:has(.team-page-animated) {
  overflow: hidden;
  height: 100vh;
  overscroll-behavior: none;
}

html:has(.team-page-animated) {
  overflow: hidden;
  height: 100vh;
  overscroll-behavior: none;
}

.team-page-animated {
  position: relative;
  width: 100%;
  height:100%;
  /* min-height: 100vh; */
  /* height:calc(100vh - var(--header-height)); */
  overflow: hidden;
  background: var(--ltclr);
  /* display: flex; */
  display:grid;
  grid-template-columns: 1fr;
  justify-content: center;
  overscroll-behavior: none;
  padding: var(--size-7) 0;

}


.team-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--size-7);
  max-width: 1400px;
  width: 95%;
  margin: 0 auto;
  align-items: start;


}

.grid-left,
.grid-right {
  position: relative;
  height: 100%;
  width: min(600px, 100%);
  margin: 0 auto;
}

.item {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  
}

.item.lionel-image,
.item.lisa-image {
  
  height: auto;
}

.item.lionel-content,
.item.lisa-content {
  height: auto;
  min-height: 600px;
  
}

.item img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  box-shadow:
    0 25px 60px var(--shadow-clr-soft),
    0 15px 35px rgba(0, 0, 0, 0.2);
}

/* Content Styling */
.item .content-box {
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: flex-start;
  background: var(--ltbg);
  padding: var(--size-5);
  box-shadow: 0 20px 60px var(--shadow-clr-soft);
}

.lionel-content .content-box {
  clip-path: polygon(0 0, calc(100% - 30px) 0, 100% 30px, 100% 100%, 0 100%);
}

.lisa-content .content-box {
  clip-path: polygon(30px 0, 100% 0, 100% 100%, 0 100%, 0 30px);
}

.content-box h2 {
  font-size: clamp(var(--fs-700), 4vw, var(--fs-800));
  font-weight: var(--fw-bold);
  text-transform: uppercase;
  color: var(--blkclr);
  letter-spacing: 0.02em;
  margin-bottom: var(--size-2);
}

.role-label {
  display: inline-block;
  font-size: var(--fs-350);
  font-weight: var(--fw-bold);
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: var(--accent);
  margin-bottom: var(--size-8);
}

.bio-content p {
  font-size: var(--fs-450);
  line-height: var(--line-height-relaxed);
  margin-bottom: var(--size-4);
  color: var(--blkclr);
}

/* Navigation Controls */
.team-navigation {
  position: fixed;
  top: 15em;
  /* bottom: auto; */
  left: 0;
  width: 100%;
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--size-7);
  padding: var(--size-5);
  pointer-events: auto;

  

}

.nav-arrow {
  background: var(--drkbg);
  border: none;
  border-radius: 50%;
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
  color: var(--accent);
}

.nav-arrow:hover {
  background: var(--drkbg);
  transform: scale(1.1);
}

.nav-arrow:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: scale(1);
}

.nav-arrow:disabled:hover {
  background: var(--drkbg);
  transform: scale(1);
}

/* ===========================================
   DEPRECATED: Desktop-first code
   Replaced with mobile-first approach
   Date: December 2025
   =========================================== */
/*
@media (max-width: 1024px) {
  .team-grid {
    grid-template-columns: 1fr;
    gap: var(--size-7);
    width: 95%;
  }

  .grid-left,
  .grid-right {
    max-width: 600px;
    margin: 0 auto;
  }
}

@media (max-width: 768px) {
  .content-box {
    padding: var(--size-5);
  }
}
*/

/* Mobile-First Responsive */
@media (min-width: 48em) {
  .item .content-box {
    padding: var(--size-7);
  }
}

@media (min-width: 64em) {
  .team-grid {
    grid-template-columns: 1fr 1fr;
    gap: var(--size-9);
    width: 90%;
  }

  .grid-left,
  .grid-right {
    max-width: none;
    margin: 0;
  }
  
.team-navigation {
  position:absolute;
  top: auto;
  left:0;
  bottom: 25em;
}
}
</style>

</MainLayout>
